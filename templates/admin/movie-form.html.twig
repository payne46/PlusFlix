<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{{ action == 'add' ? 'Dodaj film' : 'Edytuj film' }}{% endblock %}</title>

    {% block stylesheets %}
        <link rel="stylesheet" href="{{ asset('css/admin-forms.css') }}">
        <style>
            .color-preview {
                display: inline-block;
                width: 30px;
                height: 30px;
                border: 1px solid #ccc;
                border-radius: 4px;
                margin-left: 10px;
                vertical-align: middle;
            }
        </style>
    {% endblock %}
</head>
<body>

<div class="container">
    <div class="topbar">
        PLUSFLIX: {{ action == 'add' ? 'Dodawanie nowego filmu' : 'Edycja filmu' }}
    </div>

    <div class="form-container">
        <div class="form-header">
            {{ action == 'add' ? 'DODAJ NOWY FILM' : 'EDYTUJ FILM' }}
        </div>

        {% if action == 'edit' %}
            <div class="form-info">
                Edytujesz film o ID: {{ id }}
            </div>
        {% endif %}

        <form method="POST">
            <div class="form-group">
                <label class="form-label" for="title">Tytuł *</label>
                <input class="form-input" type="text" id="title" name="title" {% if action == 'edit' %}value="{{ movie.title }}"{% endif %} required>
            </div>

            <div class="form-group">
                <label class="form-label" for="description">Opis</label>
                <textarea class="form-textarea" id="description" name="description">{% if action == 'edit' %}{{ movie.description }}{% endif %}</textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="director">Reżyser</label>
                    <input class="form-input" type="text" id="director" name="director" {% if action == 'edit' %}value="{{ movie.director }}"{% endif %}>
                </div>

                <div class="form-group">
                    <label class="form-label" for="screenwriter">Scenarzysta</label>
                    <input class="form-input" type="text" id="screenwriter" name="screenwriter" {% if action == 'edit' %}value="{{ movie.screenwriter }}"{% endif %}>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="genre">Gatunek</label>
                    <input class="form-input" type="text" id="genre" name="genre" {% if action == 'edit' %}value="{{ movie.genre }}"{% endif %}>
                </div>

                <div class="form-group">
                    <label class="form-label" for="country">Kraj</label>
                    <input class="form-input" type="text" id="country" name="country" {% if action == 'edit' %}value="{{ movie.country }}"{% endif %}>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="releaseDate">Data premiery</label>
                    <input class="form-input" type="date" id="releaseDate" name="releaseDate" {% if action == 'edit' %}value="{{ movie.releaseDate|date('Y-m-d') }}"{% endif %}>
                </div>

                <div class="form-group">
                    <label class="form-label" for="length">Długość (minuty)</label>
                    <input class="form-input" type="number" id="length" name="length" {% if action == 'edit' %}value="{{ movie.length }}"{% endif %}>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="rating">Ocena</label>
                    <input class="form-input" type="number" step="0.1" min="0" max="5" id="rating" name="rating" {% if action == 'edit' %}value="{{ movie.rating }}"{% endif %}>
                </div>

                <div class="form-group">
                    <label class="form-label" for="banner">Baner</label>
                    <div style="display: flex; align-items: center;">
                        <input class="form-input" type="text" id="banner" name="banner" {% if action == 'edit' %}value="{{ movie.banner }}"{% endif %} style="flex: 1;">
                        <div id="colorPreview" class="color-preview"></div>
                    </div>
                    <small>Wpisz URL obrazka lub kolor HEX (zaczynający się od #)</small>
                </div>
            </div>

            <div class="form-actions">
                <a href="{{ path('admin_main_panel') }}" class="form-button secondary">Anuluj</a>
                <button type="submit" class="form-button primary">Zapisz</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function()
    {
        const bannerInput = document.getElementById('banner');
        const colorPreview = document.getElementById('colorPreview');

        function updateColorPreview()
        {
            const value = bannerInput.value.trim();

            if (value.startsWith('#'))
            {
                colorPreview.style.backgroundColor = value;
                colorPreview.style.display = 'inline-block';
            }
            else
            {
                colorPreview.style.display = 'none';
            }
        }

        updateColorPreview();
        bannerInput.addEventListener('input', updateColorPreview);
    });
</script>

</body>
</html>
